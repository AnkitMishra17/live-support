<!DOCTYPE html>
<html>
<head>
  <title></title>
	<meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
	<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.7.0/animate.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.0.4/socket.io.js"></script>
 <link href="https://fonts.googleapis.com/css?family=Ubuntu" rel="stylesheet">
<link href="https://fonts.googleapis.com/css?family=Livvic&display=swap" rel="stylesheet">    
 <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">
 <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.css" integrity="sha256-GqiEX9BuR1rv5zPU5Vs2qS/NSHl1BJyBcjQYJ6ycwD4=" crossorigin="anonymous" />
  <script src="https://code.jquery.com/jquery-latest.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/typeit/6.0.3/typeit.min.js" integrity="sha256-jl1b2Wp4cXCUyX8FxPZ8Z0PPIPV3QYNb/jPSLGDej2c=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.js" integrity="sha256-pQBbLkFHcP1cy0C8IhoSdxlm0CtcH5yJ2ki9jjgR03c=" crossorigin="anonymous"></script>
</head>
<link rel="stylesheet" href="./bootstrap.min.css">
<style type="text/css">
  #videolist
  {
    width: 80%;

  }
    .dlcontent
  {
    display: inline-block;

    margin-left: 15px;
  }
  #comment
  {
    min-height: 140px;
  }
  #videoplay
  {
    width: 100%;
    height: 470px;
    background-color: cyan;
  }
  #txtarea
  {
    width: 100%;
    height: 40px;
    resize: none;
    margin-top: 30px;
    margin-right: 18px;
  }
  .sptxt
  {
    font-family: verdana;
    font-size: 18px;
    color: rgb(23, 96, 78);
    text-transform: uppercase;
  }
  #commenttxt
  {
    box-shadow: 2px 2px 5px rgba(86, 173, 151,0.7);
    width: 100%;
    margin-top: 5px;
    padding-bottom: 30px;
    border: 1px solid rgb(22, 91, 74);
    padding-left: 5px;
  }
  #listcont
  {
    padding: 0px;
    margin: 0px;
  }
  #listcont div
  {
    background-color: rgb(237, 241, 244);
    border:1px solid darkgrey;
    box-shadow: 2px 2px 3px lightgrey;
  }
  .sptxt span
  {
    font-size: 15px;
    color: darkcyan;
    text-transform: lowercase;
  }

@media screen and (max-width: 768px)
{
  #videolist
  {
    width: 100%;

  }
  .toggle-btn
  {
    margin: 10px 10px;
    border: 1px solid darkgrey;
    display: inline-block;
  }
      .toggle-btn span
  {
    display:block;
    width: 30px;height: 4px;
    background-color: black;
    margin:3px 0px;
  }
  #listcont
  {
    position: absolute;
    left: -600px;
    transition: all 0.4s;
    transition-timing-function: cubic-bezier(0.1,0.4,1.0,0.9);

  }
  #listcont.active
  {
   position: relative;
   left: 0px;
  }
  * {
      box-sizing: border-box;
  }

  div#change_username, section#input_zone {
      border: 5px outset #8258FA;
  }

  div#change_username {
      height: 3%;
      display: inline-block;
      background-color: #BCA9F5;
  }

  .vertical-align {
      position: relative;
      top: 50%;
      -webkit-transform: translateY(-50%);
      -ms-transform: translateY(-50%);
      transform: translateY(-50%);
  }
}

@mixin vertical-align {
  position: relative;
  top: 50%;
  -webkit-transform: translateY(-50%);
  -ms-transform: translateY(-50%);
  transform: translateY(-50%);
}

.vertical-align {
    position: relative;
    top: 50%;
    -webkit-transform: translateY(-50%);
    -ms-transform: translateY(-50%);
    transform: translateY(-50%);
}

body{
    font-family: 'Ubuntu', sans-serif;
    background-image: linear-gradient(90deg, #cfd9df 0%, #e2ebf0 100%);
}
h1{
    background-image: linear-gradient(120deg, #fdfbfb 0%, #ebedee 100%);
    padding: 10px;
}
#caption{
    margin: 30px auto;
    
    }
#chat{
    max-width: 600px;
    margin: 30px auto;
    box-shadow: 1px 3px 5px rgba(0,0,0,0.05);
    border-radius: 2px;
}

#chat:hover{
    transform: scale(1.03);
    transition: 0.3s;
    box-shadow: 10px 20px 25px 20px rgba(0,0,0,0.25);
}

#chat-window{
    height: 50vh;
    overflow: auto;
    background-image: linear-gradient(120deg, #fdfbfb 0%, #ebedee 100%);
}

#output p{
    padding: 14px 0px;
    margin: 0 20px;
    border-bottom: 1px solid #e9e9e9;
    color: #555;
}

#feedback p{
    color: #aaa;
    padding: 14px 0px;
    margin: 0 20px;
}

#output strong{
    color: #575ed8;
}

label{
    box-sizing: border-box;
    display: block;
    padding: 10px 20px;
}
.btn-md:hover{
        transform: scale(1.05);
        background: linear-gradient(to bottom, #323232 0%, #3F3F3F 40%, #1C1C1C 150%), linear-gradient(to top, rgba(255,255,255,0.40) 0%, rgba(0,0,0,0.25) 200%);
        background-blend-mode: multiply;
        transition: 0.4s;
    }
input{
    padding: 10px 20px;
    box-sizing: border-box;
    border: 0;
    display: block;
    width: 100%;
    background: #fff;
    border-bottom: 1px solid #eee;
    font-size: 16px;
}

button{
    background: #73C2FB;
    color: #fff;
    font-size: 18px;
    border: 0;
    padding: 12px 0;
    width: 100%;
    border-radius: 0 0 2px 2px;
}
    #banner{
        background-image: url("./bg2.png");
        background-position: top;
        background-repeat: no-repeat;
        background-attachment: fixed;
        background-size: cover;
        height: 555px;
    }    
</style>

<body>
   <section id="banner">
	<header class="main_header col-md-12">
    <nav class="navbar navbar-expand-lg ">
      <a class="navbar-brand" href="#"><img src="../images/logo.jpg" alt="" class="logo"></a>
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
    <i class="fas fa-bars" style="font-size:30px;color:white;"></i>
    </button>

    <% if(username!='Not Set'){ %>
      <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto" style="margin-top:40px;">
         <li class="nav-item" >
    <div class="dropdown" style="margin-right:10px;float:right;">
         <button class="btn btn-primary dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            <input type="text" class="bg-primary text-white" id="username" value="<%= username %>" disabled/>
         </button>
        <div class="dropdown-menu" aria-labelledby="dropdownMenuButton" style="float:right;margin-right:40px;">
          <a class="dropdown-item" href="/user/profile">Profile</a>
          <a class="dropdown-item" href="/user_logout">Log Out</a>
      </div>
    </div>
  </li>
</ul>
</div>

    <%  }else{   %>
      <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto" style="margin-top:40px;">
         <li class="nav-item" >
           <div class="search-form">
            <form>
              <div class="search_form_inner">
                <input type="text" name="" placeholder="Search For Your Course Here...">
                <button type="submit"><i class="fa fa-search"></i></button>
              </div>
            </form>
          </div>
        </li>
         <li class="nav-item">
        <a class="nav-link" href="/userLogin">Login</a>
        </li>
        <li class="nav-item">
        <a class="nav-link" href="/userSignup">Sign Up</a>
        </li>
       </ul>
      </div>
      <% } %>
    </nav>
  </header>
    </section>

       <div class="toggle-btn" onclick="togglesidelist()" style="width:60px;height:60px;">
         <i class="fas fa-comment-dots" style="font-size:40px;margin-top:5px;margin-left:5px;"></i>
       </div>
        <div class="p-5">
        <div class="row">
            <div class="col-sm-4 p-4" data-aos="fade-right">
                <div id="caption m-5">
                   <button type="button" class="btn btn-primary btn-md p-4 btn-block" style="border-radius: 50px">
                      <h2 class="text-white"  style="font-family: 'Quicksand', sans-serif;">
                       Get in touch with us 
                      </h2>
                   </button>
                    <p id="chatsupport" class="text-primary" style="font-size: 30px; font-family: 'Livvic', sans-serif; ">
                        
                    </p>
                </div>
            </div>
            <div class="col-sm-8" data-aos="fade-left">
               <div id="chat" class="animated fadeIn slow">
                <h1 class="text-center">Opdemy chat support</h1>
                       <div id="chat-window">
                           <div id="output"></div>
                           <div id="feedback"></div>
                       </div>
                       <div id="box">
                        <input id="message" type="text" placeholder="Message" />
                        <button id="send_message">Send</button>
                       </div>
               </div>
           </div>
       </div>
       </div>
        <div class="row ml-1" id="videolist">
         <div class="col-12 col-sm-3 " id="listcont">
         </div>

      <div class="col col-md-9" id="commentcont">

        <div class="my-5" id="video" data-aos="fade-up">
          <script src="https://cdn.bootcss.com/flv.js/1.5.0/flv.min.js"></script>
          <video id="videoElement" controls style="width:100%;"></video>
          <script>
      if (flvjs.isSupported()) {
          var videoElement = document.getElementById('videoElement');
          var flvPlayer = flvjs.createPlayer({
              type: 'flv',
              url: 'https://www.musicsensation.org/live/STREAM_NAME.flv'
          });
          flvPlayer.attachMediaElement(videoElement);
          flvPlayer.load();
          flvPlayer.play();
      }
  </script>
        </div>
      <!--  <div class="row col-md-9 m-0 mt-4  " id="comment">
          <div id="commenttxt">
          <span class="sptxt">Anonymous : <span id="txt1" >this is a comment</span></span><br>
          <span class="sptxt">Anonymous : <span id="txt2" >this is a comment</span></span><br>
          <span class="sptxt">Anonymous : <span id="txt3" >this is a comment</span></span><br>

          </div>



          <textarea  placeholder="write comment here" id="txtarea"></textarea>
          <div class=" w-100">
          <button class="btn btn-outline-info btn-sm m-3" style="float: right;" id="cmtbtn">comment</button>
          </div>


        </div>
-->
    </div>
       </div>


<script>

   	//make connection
	var socket = io.connect('/')
    
    AOS.init();
    
	//buttons and inputs
	var message = document.getElementById('message');
	    username = document.getElementById('username');
      output = document.getElementById('output');
	    send_message = document.getElementById('send_message');
      chatroom = document.getElementById('chatroom');
      feedback = document.getElementById('feedback');

  var username = '<%= userreal %>';    

/*
	send_message.click(function(){
		socket.emit('new_message', {message : message.val(), username: username})
	})
*/

/*
	//Listen on new_message
	socket.on("new_message", (data) => {
        console.log(data);
		feedback.html('');
		message.val('');
		chatroom.append("<p class='message'>" + data.username + ": " + data.message + "</p>")
	})
*/

	//Emit a username

    //updated
    let timeout;

    function timeoutFunction() {
        typing = false;
        socket.emit("typing", false);
    }

    send_message.addEventListener('click',()=>{
      socket.emit('new_message',{
        message: message.value,
        username: username
      });
      message.value = "";
    });

    socket.on('new_message',(data)=>{

        feedback.innerHTML ="";
        output.innerHTML += '<p><strong>' + data.username + ': </strong>' + data.message + '</p>';
    });

    message.addEventListener('keypress',()=>{

      typing = true;
      socket.emit('typing', {username:username});
      clearTimeout(timeout);
      timeout = setTimeout(timeoutFunction, 1000);
    });

/*	//Emit typing
	message.bind("keypress", () => {
		socket.emit('typing', {username:username})
	})

	//Listen on typing
	socket.on('typing', (data) => {
		feedback.html("<p><i>" + data.username + " is typing a message..." + "</i></p>")
	})*/

    //mycode
    message.addEventListener('keypress',()=>{

        typing = true;
        socket.emit('typing', {username:username});
        clearTimeout(timeout);
        timeout = setTimeout(timeoutFunction, 1000);
    });

    socket.on('typing',(data)=>{
        if(data){
            feedback.innerHTML = '<p><em>' + data + ' is typing a message...</em></p>';
        }else{
            feedback.innerHTML = '';
        }
    });

    new TypeIt('#chatsupport', {
  strings: ["<h2>Need Help?</h2>", "Connect with our customer service specialists in real time,from the comfort of home."],
  speed: 50,
  waitUntilVisible: true
}).go();



</script>
</body>
</html>
